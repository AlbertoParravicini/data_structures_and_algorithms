edges_to_be_changed <- neighbors(g, as.character(to_vertex))
for (j in 1:length(edges_to_be_changed)) {
g <- g + edge(from_vertex, edges_to_be_changed[j])
}
g <- delete.vertices(g, to_vertex)
g <- simplify(g, remove.multiple = F, remove.loops = T)
plot(g)
# mapping <- seq(1, length(V(g)))
# mapping[to_vertex] <- mapping[from_vertex]
# g <- contract(g, mapping, vertex.attr.comb = "first")
# #g <- delete.vertices(g, which(degree(g) == 0))
# g <- delete.vertices(g, to_vertex)
# g <- simplify(g, remove.multiple = F, remove.loops = T)
# plot(g)
# print(g)
}
}
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut()
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut <- function(num_vertices = 4, num_edges = 6) {
g <- make_random_connected_graph(num_vertices, num_edges)
for(i in 1:(num_vertices - 2)) {
# Select a random edge.
random_edge <- E(g)[sample(1:length(E(g)), 1)]
from_vertex <- as.numeric(ends(g, random_edge)[[1]])
to_vertex <- as.numeric(ends(g, random_edge)[[2]])
print("to vertex")
print(to_vertex)
edges_to_be_changed <- neighbors(g, as.character(to_vertex))
for (j in 1:length(edges_to_be_changed)) {
g <- g + edge(from_vertex, edges_to_be_changed[j])
}
g <- delete.vertices(g, as.character(to_vertex))
g <- simplify(g, remove.multiple = F, remove.loops = T)
plot(g)
# mapping <- seq(1, length(V(g)))
# mapping[to_vertex] <- mapping[from_vertex]
# g <- contract(g, mapping, vertex.attr.comb = "first")
# #g <- delete.vertices(g, which(degree(g) == 0))
# g <- delete.vertices(g, to_vertex)
# g <- simplify(g, remove.multiple = F, remove.loops = T)
# plot(g)
# print(g)
}
}
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut <- function(num_vertices = 4, num_edges = 6) {
g <- make_random_connected_graph(num_vertices, num_edges)
for(i in 1:(num_vertices - 2)) {
# Select a random edge.
random_edge <- E(g)[sample(1:length(E(g)), 1)]
from_vertex <- ends(g, random_edge)[[1]]
to_vertex <- ends(g, random_edge)[[2]]
print("to vertex")
print(to_vertex)
edges_to_be_changed <- as.character(neighbors(g, to_vertex))
for (j in 1:length(edges_to_be_changed)) {
g <- g + edge(from_vertex, edges_to_be_changed[j])
}
g <- delete.vertices(g, to_vertex)
g <- simplify(g, remove.multiple = F, remove.loops = T)
plot(g)
# mapping <- seq(1, length(V(g)))
# mapping[to_vertex] <- mapping[from_vertex]
# g <- contract(g, mapping, vertex.attr.comb = "first")
# #g <- delete.vertices(g, which(degree(g) == 0))
# g <- delete.vertices(g, to_vertex)
# g <- simplify(g, remove.multiple = F, remove.loops = T)
# plot(g)
# print(g)
}
}
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut <- function(num_vertices = 4, num_edges = 6) {
g <- make_random_connected_graph(num_vertices, num_edges)
for(i in 1:(num_vertices - 2)) {
# Select a random edge.
random_edge <- E(g)[sample(1:length(E(g)), 1)]
from_vertex <- as.numeric(ends(g, random_edge)[[1]])
to_vertex <- as.numeric(ends(g, random_edge)[[2]])
print("to vertex")
print(to_vertex)
edges_to_be_changed <- neighbors(g, as.character(to_vertex))
for (j in 1:length(edges_to_be_changed)) {
g <- g + edge(as.character(from_vertex), as.character(edges_to_be_changed[j]))
}
g <- delete.vertices(g, as.character(to_vertex))
g <- simplify(g, remove.multiple = F, remove.loops = T)
plot(g)
# mapping <- seq(1, length(V(g)))
# mapping[to_vertex] <- mapping[from_vertex]
# g <- contract(g, mapping, vertex.attr.comb = "first")
# #g <- delete.vertices(g, which(degree(g) == 0))
# g <- delete.vertices(g, to_vertex)
# g <- simplify(g, remove.multiple = F, remove.loops = T)
# plot(g)
# print(g)
}
}
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut <- function(num_vertices = 4, num_edges = 6) {
g <- make_random_connected_graph(num_vertices, num_edges)
for(i in 1:(num_vertices - 2)) {
# Select a random edge.
random_edge <- E(g)[sample(1:length(E(g)), 1)]
from_vertex <- as.numeric(ends(g, random_edge)[[1]])
to_vertex <- as.numeric(ends(g, random_edge)[[2]])
print("to vertex")
print(to_vertex)
edges_to_be_changed <- neighbors(g, as.character(to_vertex))
for (j in 1:length(edges_to_be_changed)) {
g <- g + edge(from_vertex, as.character(edges_to_be_changed[j]))
}
g <- delete.vertices(g, as.character(to_vertex))
g <- simplify(g, remove.multiple = F, remove.loops = T)
plot(g)
# mapping <- seq(1, length(V(g)))
# mapping[to_vertex] <- mapping[from_vertex]
# g <- contract(g, mapping, vertex.attr.comb = "first")
# #g <- delete.vertices(g, which(degree(g) == 0))
# g <- delete.vertices(g, to_vertex)
# g <- simplify(g, remove.multiple = F, remove.loops = T)
# plot(g)
# print(g)
}
}
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut <- function(num_vertices = 4, num_edges = 6) {
g <- make_random_connected_graph(num_vertices, num_edges)
for(i in 1:(num_vertices - 2)) {
# Select a random edge.
random_edge <- E(g)[sample(1:length(E(g)), 1)]
from_vertex <- as.numeric(ends(g, random_edge)[[1]])
to_vertex <- as.numeric(ends(g, random_edge)[[2]])
print("to vertex")
print(to_vertex)
edges_to_be_changed <- neighbors(g, as.character(to_vertex))
for (j in 1:length(edges_to_be_changed)) {
g <- g + edge(from_vertex, edges_to_be_changed[j])
}
g <- delete.vertices(g, as.character(to_vertex))
g <- simplify(g, remove.multiple = F, remove.loops = T)
plot(g)
# mapping <- seq(1, length(V(g)))
# mapping[to_vertex] <- mapping[from_vertex]
# g <- contract(g, mapping, vertex.attr.comb = "first")
# #g <- delete.vertices(g, which(degree(g) == 0))
# g <- delete.vertices(g, to_vertex)
# g <- simplify(g, remove.multiple = F, remove.loops = T)
# plot(g)
# print(g)
}
}
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut <- function(num_vertices = 4, num_edges = 6) {
g <- make_random_connected_graph(num_vertices, num_edges)
for(i in 1:(num_vertices - 2)) {
# Select a random edge.
random_edge <- E(g)[sample(1:length(E(g)), 1)]
from_vertex <- as.numeric(ends(g, random_edge)[[1]])
to_vertex <- as.numeric(ends(g, random_edge)[[2]])
print("to vertex")
print(to_vertex)
edges_to_be_changed <- neighbors(g, as.character(to_vertex))
for (j in 1:length(edges_to_be_changed)) {
g <- g + edge(as.character(from_vertex), edges_to_be_changed[j])
}
g <- delete.vertices(g, as.character(to_vertex))
g <- simplify(g, remove.multiple = F, remove.loops = T)
plot(g)
# mapping <- seq(1, length(V(g)))
# mapping[to_vertex] <- mapping[from_vertex]
# g <- contract(g, mapping, vertex.attr.comb = "first")
# #g <- delete.vertices(g, which(degree(g) == 0))
# g <- delete.vertices(g, to_vertex)
# g <- simplify(g, remove.multiple = F, remove.loops = T)
# plot(g)
# print(g)
}
}
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
karger_random_min_cut(10, 20)
num_edges = 10
num_edges = 8
num_vertices = 5
g <- make_random_connected_graph(num_vertices, num_edges)
random_edge <- E(g)[sample(1:length(E(g)), 1)]
from_vertex <- as.numeric(ends(g, random_edge)[[1]])
to_vertex <- as.numeric(ends(g, random_edge)[[2]])
edges_to_be_changed <- neighbors(g, as.character(to_vertex))
library(igraph)
library(dplyr)
library(ggplot2)
setwd("C:\\Users\\albyr\\OneDrive\\Documenti\\ULB\\First Year\\Data Structures and Algorithms\\Assigments\\Assignment 1 - Karger's Algorithm")
# Generate a random connected graph with given number of vertices and edges.
make_random_connected_graph <- function(num_vertices = 10, num_edges = 20, details = T) {
g <- make_empty_graph(directed = F)
g <- g + vertex("1")
# Add a new vertex, connect it to a random existing vertex.
# Repeat the process num_vertices times.
for(i in 2:num_vertices) {
random_vertex <- V(g)[sample(1:length(V(g)), 1)]
g <- g + vertex(as.character(i))
g <- g + edge(i, random_vertex)
}
# Add the remaining num_edges - num_vertices edges.
for(j in 1:(num_edges - num_vertices + 1)) {
# Select two random, distinct vertices.
random_vertices <- V(g)[sample(1:length(V(g)), 2, replace = F)]
g <- g + edge(random_vertices[1], random_vertices[2])
}
if(details) {
plot(g)
print(g)
}
return(g)
}
# Given a graph, compute the min_cut with Karger's algorithm.
# "plot_graphs" and "plot_intermediate_graphs" control the verbosity of the output,
# and are used for debugging
karger_random_min_cut <- function(g, plot_graphs = T, plot_intermediate_graphs = F) {
if(plot_graphs) {
plot(g)
print(g)
}
num_vertices = length(V(g))
for(i in 1:(num_vertices - 2)) {
# Select a random edge, and keep its endpoints.
random_edge <- E(g)[sample(1:length(E(g)), 1)]
from_vertex <- ends(g, random_edge)[[1]]
to_vertex <- ends(g, random_edge)[[2]]
# Contract the selected edge.
edges_to_be_changed <- neighbors(g, to_vertex)
for (j in 1:length(edges_to_be_changed)) {
g <- g + edge(from_vertex, V(g)[edges_to_be_changed[j]]$name)
}
g <- delete.vertices(g, to_vertex)
g <- simplify(g, remove.multiple = F, remove.loops = T)
if (plot_intermediate_graphs) {
plot(g)
}
}
if(plot_graphs) {
plot(g)
print(g)
}
# Return the number of edges, as our randomized min_cut
return(length(E(g)))
}
disc <- F
while (!disc) {
g <- sample_gnm(100, 1000)
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gvn(50, 200)
g <- g1 %u% g2
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %u% g2
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %u% g2
plot(g)
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %du% g2
plot(g)
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %du% g2
plot(g)
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
?min_cut
?is.connected
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %du% g2
plot(g)
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %du% g2
plot(g)
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %du% g2
plot(g)
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %du% g2
plot(g)
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %du% g2
plot(g)
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
disc <- F
while (!disc) {
g1 <- sample_gnm(50, 200)
g2 <- sample_gnm(50, 200)
g <- g1 %du% g2
plot(g)
if (min_cut(g) == 0) {
disc = T
res <- karger_random_min_cut(g)
if (res == 0) {
print("success")
}
else {
print("XXX")
}
}
else {
print("connected")
}
}
a = 1:10
b = matrix(c(1:100), nrow = 10)
a %*% b
library(igraph)
library(dplyr)
library(ggplot2)
library(microbenchmark)
setwd("C:\\Users\\albyr\\Documents\\data_structures_and_algorithms\\Assignment 1 - Karger's Algorithm")
source("Karger's Algorithm.R")
results <- read.csv("Results/karger_incr_edges_total.csv", header = T, sep = " ")
grouped_data <- results  %>% group_by(num_vertices, num_edges) %>% summarise_each(funs(mean(.)), -iteration)
p <- ggplot(grouped_data, aes(x=num_edges, y = correct))
p <- p + geom_line(size = 1, color = "#4f72fc") + geom_point(size = 2.5, color ="#021f91")
p <- p + theme_minimal() + xlab("Number of edges") + ylab("Percentage of correct results")
p <- p + theme(axis.text=element_text(size=12), axis.title=element_text(size=14))
p <- p + scale_x_discrete(limits = grouped_data$num_edges, expand = 0.05)
p <- p  +  ggtitle(bquote(atop(.("Karger's algorithm with increasing number of edges"), atop(italic(.("Number of vertices: 50")), ""))))
poly <- data.frame(x = grouped_data$num_edges, y = 1/grouped_data$num_edges^2)
p <- p + geom_line(poly, aes(x = x, y = y))
theoretical_results <- data.frame(num_vertices = grouped_data$num_edges, baseline = 2 / (grouped_data$num_vertices * (grouped_data$num_vertices - 1)))
p <- p + geom_line(data = theoretical_results, size = 1, color = "#ff4d4d", aes(x = num_vertices, y = baseline)) + geom_point(data = theoretical_results, size = 2.5, color ="#800000", aes(x = num_vertices, y = baseline))
p
View(poly)
poly <- data.frame(x = grouped_data$num_edges, y = 1/grouped_data$num_vertices^2)
p <- p + geom_line(poly, aes(x = x, y = y))
poly <- data.frame(x = grouped_data$num_edges, y = 1/grouped_data$num_vertices^2)
p <- p + geom_line(data= poly, aes(x = x, y = y))
p
